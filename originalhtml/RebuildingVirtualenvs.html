<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>RebuildingVirtualenvs</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="pythonanywhere/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="pythonanywhere/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="pythonanywhere/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">RebuildingVirtualenvs</a>
</ul>
<br><br>
[<a href="PythonAnywhereWiki.html">PythonAnywhereWiki</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1-10"></span><p class="line867">
<h1 id="Rebuilding_a_Virtualenv">Rebuilding a Virtualenv</h1>
<span class="anchor" id="line-2-1"></span><span class="anchor" id="line-3"></span><p class="line867"><em>If you need to rebuild your virtualenv following a system upgrade</em> <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867">
<h2 id="A1.29_Indentify_your_virtualenv">1) Indentify your virtualenv</h2>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line862">Navigate to the <strong>Web</strong> tab and take a look at the <em>WSGI file</em> for each of your web apps.  At the top (if it's using a virtualenv), you'll find a line that contains the line <tt class="backtick">activate_this</tt>.  That will include the path to your virtualenv. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><ul><li><p class="line862">If the path starts with <em>/home/myusername/.virtualenvs/...</em>, then you're using virtualenvwrapper. <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span></li></ul><p class="line862">The instructions below will contain instructions for people who use plain <tt class="backtick">virtualenv</tt> and <tt class="backtick">virtualenvwrapper</tt>.  Use a <strong>Bash console</strong> to enter these commands. <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line867">
<h2 id="A2.29_Use_a_requirements.txt_file_to_record_what_packages_you.27re_using">2) Use a requirements.txt file to record what packages you're using</h2>
<span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line862">If you've already got a <em>requirements.txt</em> file, you can skip this bit, although you may want to just do the bit where we double-check what version of Python we're using. <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><ol type="i"><li>Activate your virtualenv, using <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span></li></ol><p class="line867"><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><pre><span class="anchor" id="line-1"></span>source /home/myusername/path/to/virtualenv/bin/activate</pre><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><p class="line874">Or, if using virtualenvwrapper: <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><p class="line867"><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><pre><span class="anchor" id="line-1-1"></span>source virtualenvwrapper.sh
<span class="anchor" id="line-2"></span>workon my-virtualenv-name</pre><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><ul><li style="list-style-type:none">ii. Save the list of packages to a requirements file <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span></li></ul><p class="line867"><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><pre><span class="anchor" id="line-1-2"></span>pip freeze &gt; /tmp/requirements.txt</pre><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><ul><li style="list-style-type:none">iii. Double-check which version of python is in your virtualenv <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span></li></ul><p class="line867"><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><pre><span class="anchor" id="line-1-3"></span>python --version</pre><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><ul><li style="list-style-type:none">iv. Deactivate the virtualenv <span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span></li></ul><p class="line867"><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><pre><span class="anchor" id="line-1-4"></span>deactivate</pre><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><p class="line867">
<h2 id="A3.29_Delete_your_old_virtualenv">3) Delete your old virtualenv</h2>
<span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><p class="line867"><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><pre><span class="anchor" id="line-1-5"></span>rm -rf /home/myusername/path/to/virtualenv</pre><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><p class="line874">or, if using virtualenvwrapper: <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><p class="line867"><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><pre><span class="anchor" id="line-1-6"></span>rmvirtualenv my-virtualenv-name</pre><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><p class="line867">
<h2 id="A4.29_Rebuild_a_new_virtualenv">4) Rebuild a new virtualenv</h2>
<span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><p class="line874">Using the appropriate Python version: <span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><p class="line867"><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><pre><span class="anchor" id="line-1-7"></span>virtualenv --python=/usr/bin/pythonX.Y /home/myusername/path/to/virtualenv</pre><span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line874">or, with virtualenvwrappper <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line867"><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><pre><span class="anchor" id="line-1-8"></span>mkvirtualenv --python=/usr/bin/pythonX.Y my-virtualenv-name</pre><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><p class="line867">
<h2 id="A5.29_Reinstall_your_packages">5) Reinstall your packages</h2>
<span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><p class="line867"><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><pre><span class="anchor" id="line-1-9"></span>pip install -r /tmp/requirements.txt  # or path to your existing requirements.txt</pre><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><p class="line867">
<h2 id="A6.29_Restart_your_web_app.">6) Restart your web app.</h2>
<span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><p class="line862">Back on the <strong>Web</strong> tab. <span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><p class="line874">If you have multipe web apps with multiple different virtualenvs, you'll need to do this for each one, obviously. <span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><p class="line874">We're here to help!  If you get stuck or confused, just drop us a note, and we'll be happy to help. <span class="anchor" id="line-94"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2015-09-17 14:07
</body>
</html>
