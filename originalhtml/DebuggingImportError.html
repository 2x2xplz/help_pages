<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>DebuggingImportError</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="pythonanywhere/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="pythonanywhere/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="pythonanywhere/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">DebuggingImportError</a>
</ul>
<br><br>
[<a href="PythonAnywhereWiki.html">PythonAnywhereWiki</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1-11"></span><p class="line867">
<h1 id="Debugging_with_sys.path_.2F_ImportError_issues">Debugging with sys.path / ImportError issues</h1>
<span class="anchor" id="line-2-7"></span><span class="anchor" id="line-3-5"></span><p class="line867">
<h2 id="The_theory">The theory</h2>
<span class="anchor" id="line-4-4"></span><span class="anchor" id="line-5-3"></span><p class="line874">When you say: <span class="anchor" id="line-6-2"></span><span class="anchor" id="line-7"></span><p class="line867"><span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-1-12"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e17fe37622310d273fa806285d46d06661561b58\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e17fe37622310d273fa806285d46d06661561b58" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e17fe37622310d273fa806285d46d06661561b58_1">   1</a> </span><span class="LineAnchor" id="CA-e17fe37622310d273fa806285d46d06661561b58_1"></span><span class="anchor" id="line-1-13"></span><span class="ResWord">from</span> <span class="ID">foo.bar</span> <span class="ResWord">import</span> <span class="ID">baz</span></span>
</pre></div></div><span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line862">Python will start by looking for a <em>module</em> named foo, and then inside that a module named bar, and then inside that for an object named baz (which may be a regular python object, or another module) <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><p class="line862">A <strong>module</strong> is defined as: <span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><ul><li>either a Python file <span class="anchor" id="line-16"></span><ul><li style="list-style-type:none">- ie a file on disk that ends in .py and contains valid Python (syntax errors, for example, will stop you from being able to import a file) <span class="anchor" id="line-17"></span></li></ul></li><li>or a folder which contains Python files. <span class="anchor" id="line-18"></span><ul><li style="list-style-type:none"><p class="line862">- for a folder to become a module, it must contain a special file called <tt class="backtick">__init__.py</tt> <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span></li></ul></li></ul><p class="line874">When a module is actually a folder, the things you can import from it are: <span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><ul><li>any other modules that are inside the folder (ie, more .py files and folders) <span class="anchor" id="line-24"></span></li><li><p class="line862">any objects defined or imported inside the <tt class="backtick">__init__.py</tt> of the folder <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span></li></ul><p class="line874">Finally, where does Python look for modules?  It looks in each directory specified in the special "sys.path" variable.  Typically (but not always), sys.path contains some default folders, including the current working directory, and the standard "packages" directory for that system, usually called site-packages, which is where pip installs stuff to. <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><p class="line862">So <tt class="backtick">from&nbsp;foo.bar&nbsp;import&nbsp;baz</tt> could work in a few different ways: <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><p class="line867"><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><pre><span class="anchor" id="line-1"></span>.
<span class="anchor" id="line-2"></span>`-- foo/
<span class="anchor" id="line-3"></span>    |-- __init__.py
<span class="anchor" id="line-4"></span>    `-- bar.py          &lt;-- contains a variable called "baz"</pre><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><p class="line874">Or <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><p class="line867"><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><pre><span class="anchor" id="line-1-1"></span>.
<span class="anchor" id="line-2-1"></span>`-- foo/
<span class="anchor" id="line-3-1"></span>    |-- __init__.py
<span class="anchor" id="line-4-1"></span>    `-- bar/
<span class="anchor" id="line-5"></span>        |-- __init__.py
<span class="anchor" id="line-6"></span>        `-- baz.py</pre><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><p class="line874">Or:  <span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><p class="line867"><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><pre><span class="anchor" id="line-1-2"></span>.
<span class="anchor" id="line-2-2"></span>`-- foo/
<span class="anchor" id="line-3-2"></span>    |-- __init__.py
<span class="anchor" id="line-4-2"></span>    `-- bar/
<span class="anchor" id="line-5-1"></span>        `-- __init__.py     &lt;-- contains a variable called "baz"</pre><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><p class="line874">What this means is that you need to get  a few things right for an import to work: <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><p class="line874">1. The dot-notation has to work:  from foo.bar import baz means foo has to be a module folder, and bar can either be a folder or a file, as long as it somehow contains a thing called baz.  Spelling mistakes, including capitalization, matter <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><p class="line874">2. The top-level "foo" must be inside a folder that's on your sys.path. <span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><p class="line874">3. If you have multiple modules called "foo" on your sys.path, that will probably lead to confusion. Python will just pick the first one. <span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><p class="line867">
<h2 id="Debugging_sys.path_issues_in_web_apps">Debugging sys.path issues in web apps</h2>
<span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line867">
<h3 id="can_you_run_the_wsgi_file_itself.3F">can you run the wsgi file itself?</h3>
<span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line867"><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><pre><span class="anchor" id="line-1-3"></span>$ python3.4 -i /var/www/www_my_domain_com_wsgi.py</pre><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><p class="line874">Or, if you're using python 2: <span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><p class="line867"><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><pre><span class="anchor" id="line-1-4"></span>$ python2.7 -i /var/www/www_my_domain_com_wsgi.py</pre><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><p class="line874">Or, if you're using a virtualenv, activate it first: <span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><p class="line867"><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><pre><span class="anchor" id="line-1-5"></span>$ workon my-virtualenv
<span class="anchor" id="line-2-3"></span>(my-virtualenv)$ python -i /var/www/www_my_domain_com_wsgi.py</pre><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><p class="line874">If this shows any errors and won't even load python (eg syntax errors), you'll need to fix them. <span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><p class="line874">If it loads OK, it will drop you into a Python shell. Try doing the import manually at the command line.  Then, check whether they really are coming from where you think they are: <span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><p class="line867"><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-1-14"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_1">   1</a> </span><span class="LineAnchor" id="CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_1"></span><span class="anchor" id="line-1-15"></span><span class="ResWord">from</span> <span class="ID">foo.bar</span> <span class="ResWord">import</span> <span class="ID">baz</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_2">   2</a> </span><span class="LineAnchor" id="CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_2"></span><span class="anchor" id="line-2-8"></span><span class="ResWord">import</span> <span class="ID">foo</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_3">   3</a> </span><span class="LineAnchor" id="CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_3"></span><span class="anchor" id="line-3-6"></span><span class="ResWord">print</span>(<span class="ID">foo</span>)  <span class="Comment"># this should show the path to the module.  Is it what you expect?</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_4">   4</a> </span><span class="LineAnchor" id="CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_4"></span><span class="anchor" id="line-4-5"></span><span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_5">   5</a> </span><span class="LineAnchor" id="CA-6e09dd1f4f07077feedf9813fc1d693e9e71f369_5"></span><span class="anchor" id="line-5-4"></span><span class="ResWord">print</span>(<span class="String">'</span><span class="SPChar">\n</span><span class="String">'</span>.<span class="ID">join</span>(<span class="ID">sys</span>.<span class="ID">path</span>)) <span class="Comment"># does this show the files and folders you need?</span></span>
</pre></div></div><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><p class="line867">
<h2 id="Django-specific_issues">Django-specific issues</h2>
<span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span><p class="line874">In Django, we sometimes don't import modules directly in the WSGI file, but we do specify a dot-notation import path to the settings in an environment variable.  Django will try and import it later, so you need to get this right as if it was an import. <span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><p class="line874">eg: <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><p class="line867"><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><span class="anchor" id="line-1-16"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_1">   1</a> </span><span class="LineAnchor" id="CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_1"></span><span class="anchor" id="line-1-17"></span><span class="ID">path</span> = <span class="String">"</span><span class="String">/home/myusername/myproject</span><span class="String">"</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_2">   2</a> </span><span class="LineAnchor" id="CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_2"></span><span class="anchor" id="line-2-9"></span><span class="ResWord">if</span> <span class="ID">path</span> <span class="ResWord">not</span> <span class="ResWord">in</span> <span class="ID">sys</span>.<span class="ID">path</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_3">   3</a> </span><span class="LineAnchor" id="CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_3"></span><span class="anchor" id="line-3-7"></span>    <span class="ID">sys</span>.<span class="ID">path</span>.<span class="ID">append</span>(<span class="ID">path</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_4">   4</a> </span><span class="LineAnchor" id="CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_4"></span><span class="anchor" id="line-4-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_5">   5</a> </span><span class="LineAnchor" id="CA-12943f8fa8fad615c1c6750ae342a5cd14c188bf_5"></span><span class="anchor" id="line-5-5"></span><span class="ID">os</span>.<span class="ID">environ</span>(<span class="String">"</span><span class="String">DJANGO_SETTINGS_MODULE</span><span class="String">"</span>) = <span class="String">"</span><span class="String">myproject.settings</span><span class="String">"</span></span>
</pre></div></div><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><p class="line874">What this implies is that you have a directory tree that looks like this: <span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><p class="line867"><span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><pre><span class="anchor" id="line-1-6"></span>/home/myusername
<span class="anchor" id="line-2-4"></span>`-- myproject/
<span class="anchor" id="line-3-3"></span>    |-- __init__.py
<span class="anchor" id="line-4-3"></span>    `-- myrpoject/
<span class="anchor" id="line-5-2"></span>        |-- __init__.py
<span class="anchor" id="line-6-1"></span>        `-- settings.py</pre><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><p class="line862">NB - this is the typical django project structure for django versions greater than 1.4.  You will probably need to use a virtualenv to get this to work, see <a class="nonexistent" href="./VirtualenvForNewerDjango.html">VirtualenvForNewerDjango</a> <span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><p class="line874">If in doubt, try the <span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span><p class="line867"><span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><pre><span class="anchor" id="line-1-7"></span>python -i /var/www/www_my_domain_com_wsgi.py
<span class="anchor" id="line-2-5"></span>&gt;&gt;&gt; import myproject.settings
<span class="anchor" id="line-3-4"></span># this should work. if this doesn't, figure out why.  print sys.path, etc.</pre><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><p class="line867">
<h3 id="Other_tips">Other tips</h3>
<span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><p class="line867">
<h4 id="Can_you_run_the_files_it.27s_trying_to_import.3F">Can you run the files it's trying to import?</h4>
<span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><p class="line862">eg, if your wsgi file does <tt class="backtick">from&nbsp;myapp&nbsp;import&nbsp;settings</tt>, can you run: <span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><p class="line867"><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><pre><span class="anchor" id="line-1-8"></span>python /path/to/myapp/settings.py</pre><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><p class="line874">? <span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><p class="line867">
<h4 id="Shadowing">Shadowing</h4>
<span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><p class="line874">Could there be any sort of "shadowing" going on?  do any of your modules have the same name as system modules?  eg, if you're trying to do <span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><p class="line867"><span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span><pre><span class="anchor" id="line-1-9"></span>from package import thing</pre><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span><p class="line874">What happens if you open up a console and type <span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><p class="line867"><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><pre><span class="anchor" id="line-1-10"></span>import package
<span class="anchor" id="line-2-6"></span>print(package)</pre><span class="anchor" id="line-167"></span><span class="anchor" id="line-168"></span><p class="line874">does it give you the path to your package, or to a system package?  if the latter, it's best to rename your own module to avoid the conflict. <span class="anchor" id="line-169"></span><span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><p class="line867">
<h2 id="Check_virtualenv_Python_versions">Check virtualenv Python versions</h2>
<span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><p class="line874">If you're using a virtualenv, just double-check that the Python version of your virtualenv is the same as the one on the web tab. <span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><p class="line862">* you can check the virtualenv version with <tt class="backtick">python&nbsp;--version</tt> (remember to activate your virtualenv fist with <tt class="backtick">workon&nbsp;my-virtualenv-name</tt> first) <span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><p class="line862">* you can check the webapp python version on the <strong>Web</strong> tab, it's indicated near the top. <span class="anchor" id="line-178"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2015-08-21 13:55
</body>
</html>
