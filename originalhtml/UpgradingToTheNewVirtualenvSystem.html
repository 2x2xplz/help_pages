<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>UpgradingToTheNewVirtualenvSystem</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="pythonanywhere/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="pythonanywhere/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="pythonanywhere/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">UpgradingToTheNewVirtualenvSystem</a>
</ul>
<br><br>
[<a href="PythonAnywhereWiki.html">PythonAnywhereWiki</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1-1"></span><p class="line867">
<h1 id="Upgrading_to_the_new_virtualenv_system">Upgrading to the new virtualenv system</h1>
<span class="anchor" id="line-2-1"></span><span class="anchor" id="line-3-1"></span><p class="line862">Here's how to use the new, shiny virtualenv system if you were using the old (slightly hacky) solution based on <tt class="backtick">exec</tt> and <tt class="backtick">activate_this</tt>. <span class="anchor" id="line-4-1"></span><span class="anchor" id="line-5"></span><p class="line867">
<h2 id="Edit_your_wsgi_file_and_remove_the_activate_this_call">Edit your wsgi file and remove the activate_this call</h2>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line862">Go to the <strong>Web</strong> tab and follow the link to your wsgi file.  Look for the 'activate_this' lines, which should look something like this: <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line867"><span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><pre><span class="anchor" id="line-1"></span>activate_this = '/home/myusername/.virtualenvs/django17/bin/activate_this.py'
<span class="anchor" id="line-2"></span>with open(activate_this) as f:
<span class="anchor" id="line-3"></span>    code = compile(f.read(), activate_this, 'exec')
<span class="anchor" id="line-4"></span>    exec(code, dict(__file__=activate_this))</pre><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line862">Take a note of the path to your virtualenv (in this case, it's <em>/home/myusername/.virtualenvs/django17/</em>), and then just go ahead go ahead and delete those activate_this lines altogether.  Mkay. <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line867">
<h2 id="Add_the_virtualenv_path_to_your_web_app_config">Add the virtualenv path to your web app config</h2>
<span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><p class="line862">Back on the <strong>Web</strong> tab, paste in the path to your virtualenv in the virtualenv section.  Hit reload, and, hey presto!  your virtualenv should just work <span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><p class="line867">
<h2 id="If_you_see_any_errors_with_missing_modules">If you see any errors with missing modules</h2>
<span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><p class="line862">The old <tt class="backtick">activate_this</tt> system used to actually leave all the system-installed modules on the <em>sys.path</em>, which caused all sorts of weird problems with shadowing.  If you find that your web app is now showing you errors because it's missing some packages, it's probably because you were relying on some system-installed packages without realising it. <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><p class="line874">To fix it you have two choices <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><ul><li>Installed those packages explicitly into your virtualenv <span class="anchor" id="line-29"></span></li><li><p class="line862">Delete and re-create your virtualenv with the <tt class="backtick">--system-site-packages</tt> option, to explicitly make yourself a virtualenv with system packages. <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span></li></ul><p class="line874">The former is probably preferable.  We're here if you need help!  Just drop us a line in the forums. <span class="anchor" id="line-32"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2015-09-17 14:07
</body>
</html>
